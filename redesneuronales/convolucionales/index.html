
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Aprendizaje progresivo para conocer las posibilidades de la IA.">
      
      
        <meta name="author" content="IES Severo Ochoa">
      
      
        <link rel="canonical" href="https://sever8a.github.io/neuronal/redesneuronales/convolucionales/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.0b4">
    
    
      
        <title>Redes Convolucionales - Deep Learning</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.91872f81.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#redes-convolucionales" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Deep Learning" class="md-header__button md-logo" aria-label="Deep Learning" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Deep Learning
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Redes Convolucionales
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Deep Learning" class="md-nav__button md-logo" aria-label="Deep Learning" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Deep Learning
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Comenzando
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../proceso/" class="md-nav__link">
        El proceso
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/" class="md-nav__link">
        Machine vs Deep
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Pasos b치sicos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Pasos b치sicos" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Pasos b치sicos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../exploradatos/" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../exploradatos/" class="md-nav__link">
        An치lisis Exploratorio
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Redes Neuronales
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Redes Neuronales" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Redes Neuronales
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Redes Neuronales
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fundamentos/" class="md-nav__link">
        Fundamentos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../redes_profundas/" class="md-nav__link">
        Redes Densas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../temporales/" class="md-nav__link">
        Redes Recurrentes/LSTM
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Redes Convolucionales
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hiperparametros/" class="md-nav__link">
        Hiperpar치metros
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../transferencia/" class="md-nav__link">
        Transferencia de conocimiento
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/" class="md-nav__link">
        Procesamiento Lenguaje Natural
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../no_supervisado/" class="md-nav__link">
        Aprendizaje no supervisado
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tareas1/" class="md-nav__link">
        Tareas
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="redes-convolucionales">Redes convolucionales</h1>
<p>Las redes convolucionales ofrecen ventajas, frente a las redes de capas densas, para el procesamiento de im치genes.</p>
<p><img alt="&quot;Esquema convolucional&quot;" src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*CrjJwSX9S7f759dK2EtGJQ.png" /></p>
<p>Las capas convolucionales son el elemento clave en este tipo de redes.</p>
<p>Se basan en el reconocimiento de elementos caracter칤sticos de cada tipo de imagen. Aprende de l칤neas, bordes, texturas o formas.</p>
<p><img alt="&quot;Aprendizaje&quot;" src="https://www.researchgate.net/profile/Honglak-Lee/publication/220424626/figure/fig2/AS:277417953382421@1443153002703/Columns-1-4-the-second-layer-bases-top-and-the-third-layer-bases-bottom-learned-from.png" /></p>
<p>La primera capa convolucional aprende patrones b치sicos, y las siguientes capas aprenden patrones compuestos de las capas anteriores, cada vez m치s complejos.</p>
<h1 id="de-capas-densas-a-capas-convolucionales">De capas densas a capas convolucionales</h1>
<p>Las capas convolucionales operan sobre matrices de tres ejes, mapas de caracter칤sticas. Dos ejes indican las dimensiones: altura y anchura, el tercer eje es el <em>canal</em> en im치genes RGB la dimensi칩n es 3, correspondiendo con cada canal de color. Sin embargo en im치genes en blanco y negro la dimensi칩n es 1 (nivel de gris).</p>
<p>La capa convolucional, realiza una reducci칩n de la dimensi칩n de la imagen de entrada, de manera que mediante una ventana de tama침o espec칤fico va recorriendo todos los pixel de la imagen de entrada. El movimiento de esta ventana se establece con el par치metro <strong>stride</strong>.</p>
<p><img alt="&quot;El stride&quot;" src="https://d2l.ai/_images/conv-stride.svg" /></p>
<p>Al tama침o de esta ventana se denomina <strong>kernel</strong>, y corresponde a una matriz cuadrada que abarca tantos pixel como los indicados en este par치metro. Sin embargo, la combinaci칩n de estos dos par치metros para el recorrido exploratorio de toda la imagen, deja entrever que unos pixeles participan m치s que otros, concretamente los pixel m치s pr칩ximos a los bordes, quedan excluidos de m치s convoluciones.</p>
<p>Para solventar esta circunstancia se utiliza el par치metro <strong>padding</strong> que permite a침adir a la imagen un b칩rde extra de pixeles, permitiendo que el <em>kernel</em> y su desplazamiento <em>sride</em> recorra todos los pixeles (incluidos los del borde) en m치s ocasiones.</p>
<p>''' python  hl_lines="14"
import tensorflow as tf</p>
<h1 id="we-define-a-helper-function-to-calculate-convolutions-it-initializes">We define a helper function to calculate convolutions. It initializes</h1>
<h1 id="the-convolutional-layer-weights-and-performs-corresponding-dimensionality">the convolutional layer weights and performs corresponding dimensionality</h1>
<h1 id="elevations-and-reductions-on-the-input-and-output">elevations and reductions on the input and output</h1>
<p>def comp_conv2d(conv2d, X):
    # (1, 1) indicates that batch size and the number of channels are both 1
    X = tf.reshape(X, (1, ) + X.shape + (1, ))
    Y = conv2d(X)
    # Strip the first two dimensions: examples and channels
    return tf.reshape(Y, Y.shape[1:3])</p>
<h1 id="1-row-and-column-is-padded-on-either-side-so-a-total-of-2-rows-or-columns-are-added">1 row and column is padded on either side, so a total of 2 rows or columns are added</h1>
<p>conv2d = tf.keras.layers.Conv2D(1, kernel_size=3, padding='same')
X = tf.random.uniform(shape=(8, 8))
comp_conv2d(conv2d, X).shape
'''</p>
<p>Cuando la altura y anchura del kernel no son iguales, tambi칠n es posible establecer una dimensi칩n adecuada para el par치metro padding.</p>
<p>''' python hl_lines="3"</p>
<h1 id="we-use-a-convolution-kernel-with-height-5-and-width-3-the-padding-on">We use a convolution kernel with height 5 and width 3. The padding on</h1>
<h1 id="either-side-of-the-height-and-width-are-2-and-1-respectively">either side of the height and width are 2 and 1, respectively</h1>
<p>conv2d = tf.keras.layers.Conv2D(1, kernel_size=(5, 3), padding='same')
comp_conv2d(conv2d, X).shape
'''</p>
<h2 id="pooling">Pooling</h2>
<p>Aplicar este tipo de capa supone realizar una reducci칩n dimensional de la imagen previa. Hay posibilidad de utilizar el m치ximo valor, o el valor promedio, de la ventana indicada como kernel</p>
<p>El dataset de prendas de ropa de Zalando sirve para probar los resultados que se pueden conseguir con un modelo de red neuronal de capas densas, frente a una red con capas convolucionales.</p>
<p><a href="https://colab.research.google.com/drive/1VdwtqDSlz1TzNVyWU0R-X9qvrkQ-z7c5?usp=sharing">Ejemplo para comparar</a></p>
<h1 id="aumento-de-datos">Aumento de datos</h1>
<p>Permite disponer de m치s datos aplicando variaciones a las im치genes disponibles (rotaci칩n, iluminaci칩n, contraste,...).</p>
<p>En algunos casos (problemas de segmentaci칩n) puede ser necesario aplicar los mismos filtros a otros elementos del dataset relacionados con cada elemento del dataset. Por ejemplo, la m치scara en los problemas de segmentaci칩n.</p>
<h1 id="segmentacion">Segmentaci칩n</h1>
<p>Los problemas de segmentaci칩n en im치genes se basan en identificar elementos en la imagen. La estructura de los modelos es diferente a los que solucionan problemas de clasificaci칩n.</p>
<h2 id="segmentacion-semantica">Segmentaci칩n sem치ntica</h2>
<p>Consiste en determinar los elementos que componen una imagen, detectando su relevancia en la imagen. Etiquetando cada 치rea con una categor칤a de las clases utilizadas. *Se clasifican los pixels, no los objetos.</p>
<p>En la siguiente imagen se observa como sobre el total de las imagenes se establecen las zonas relevantes a: pasto, avi칩n, edificio, vaca, cielo, camino...</p>
<p><img alt="ejemplo segmentaci칩n semantica" src="https://www.researchgate.net/profile/Cristobal-Silva-5/publication/319766387/figure/fig4/AS:538875850625025@1505489422809/Figura-24-Ejemplo-de-Segmentacion-Semantica-31.png" /></p>
<h3 id="segmentacion-binaria">Segmentaci칩n binaria</h3>
<p>Es un caso particular de segmentaci칩n sem치tica, en el cual solo se clasifica cada pixel: <em>si pertenece al </em><em>fondo</em><em>, o a la </em><em>regi칩n de inter칠s</em>**.</p>
<h2 id="segmentacion-de-instancias">Segmentaci칩n de instancias</h2>
<p>Consiste en determinar los objetos de la imagnes. <em>Se clasifican los </em><em>pixels</em><em> y los </em><em>objetos</em>**.</p>
<p><img alt="Ejemplo instancias" src="https://cocodataset.org/images/detection-splash.png" /></p>
<h2 id="recursos">Recursos</h2>
<p>La base de datos <a href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR10</a> consiste en un dataset de im치genes cotidianas pertenecientes a 10 clases diferentes. </p>
<p>Dispone de unas 60.000 im치genes a color de 32 x 32. Distribuidas para entrenamiento y validaci칩n.</p>
<p>Las clases que dispone son:
- avi칩n
- autom칩bil
- p치jaro
- gato 
- ciervo
- perro
- rana
- caballo
- barco
- cami칩n</p>
<p>Una desventaja de este dataset es el tama침o (32 x 32), ya que son im치genes con baja resoluci칩n.</p>
<p>La base de datos <a href="https://cocodataset.org/#home">COCO</a> consiste en un dataset de im치genes etiquetadas con 80 categor칤as. Se utiliza para entrenar modelos para solucionar problemas de <strong>segmentaci칩n de instancias</strong>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand"], "search": "../../assets/javascripts/workers/search.3de43c86.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ce0331ff.min.js"></script>
      
    
    
  </body>
</html>